
# Guide to Designing Glossary Entries

This guide outlines the structure, content, and styling conventions for creating and updating glossary entries in the Aralia RPG application, using class entries (like the Barbarian) as a primary example.

## File Structure Overview

1.  **Source Markdown Files**:
    *   **Location**: `src/data/glossary/entries/`
    *   **Subdirectories**: Organize entries into logical subdirectories (e.g., `classes/`, `rules/`, `magic_items/`, `spells/`).
    *   **Example**: `src/data/glossary/entries/classes/barbarian.md`

2.  **Publicly Served Markdown Files**:
    *   **Location**: `public/data/glossary/entries/`
    *   **Mirroring Source**: This directory structure should **mirror** `src/data/glossary/entries/`.
    *   **Crucial for Fetching**: The application fetches Markdown content for display from these public paths. Ensure that any Markdown file created or updated in `src/` is also present (or copied) here.
    *   **Example**: `public/data/glossary/entries/classes/barbarian.md`

3.  **Generated JSON Indexes**:
    *   **Location**: `public/data/glossary/index/`
    *   **Generation**: These JSON files are generated by the `scripts/generateGlossaryIndex.js` script, which reads from the *source* Markdown files in `src/data/glossary/entries/`.
    *   **`main.json`**: Lists paths to all category-specific JSON index files.
    *   **Category JSON (e.g., `character_classes.json`)**: Contains an array of `GlossaryEntry` objects for that category, including the `filePath` for each entry.

## Markdown File Naming

*   **Convention**: `[id_lowercase].md` (e.g., `barbarian.md`, `spell_scroll.md`, `expertise.md`).
*   The filename (without `.md`) should match the `id` field in the frontmatter.

## YAML Frontmatter

Each glossary entry Markdown file **must** begin with YAML frontmatter, enclosed by `---` on both ends.

```yaml
---
id: "barbarian"  # Unique lowercase ID, matching filename (without .md)
title: "Barbarian (Class)" # Full display title
category: "Character Classes" # Helps organize the glossary index
tags: ["class", "character creation", "rage", "martial"] # Relevant keywords
excerpt: "A fierce warrior channeling primal fury." # Brief summary for listings
aliases: ["berserker"] # Common alternative names
seeAlso: ["rage", "unarmored_defense"] # IDs of related glossary terms
filePath: "/data/glossary/entries/classes/barbarian.md" # PUBLIC fetchable path
---
```

*   **`id` (Required)**:
    *   Unique, lowercase string.
    *   Used for internal linking (e.g., by `<GlossaryTooltip>` and `<span data-term-id="...">`).
    *   Should match the Markdown filename (excluding `.md`).
*   **`title` (Required)**:
    *   The human-readable title for the entry (e.g., "Barbarian (Class)", "Spell Scroll").
*   **`category` (Required)**:
    *   The primary category for the entry (e.g., "Character Classes", "Magic Items", "Rules Glossary", "Spellcasting Mechanics"). This determines which category-specific JSON index file the entry will be listed in.
*   **`tags` (Optional but Recommended)**:
    *   An array of lowercase keywords relevant for searching or filtering.
*   **`excerpt` (Optional but Recommended)**:
    *   A brief (1-2 sentence) summary of the term. Used in list views or tooltips.
*   **`aliases` (Optional)**:
    *   An array of alternative names or common synonyms for the term.
*   **`seeAlso` (Optional)**:
    *   An array of `id`s for other glossary entries that are highly relevant.
*   **`filePath` (Required)**:
    *   **Crucial**: This path **must** point to the *publicly fetchable location* of the Markdown file.
    *   It should be relative to the `public` directory.
    *   **Example**: If your source file is `src/data/glossary/entries/classes/barbarian.md`, and it's served publicly from `public/data/glossary/entries/classes/barbarian.md`, then `filePath` should be `"/data/glossary/entries/classes/barbarian.md"`.

## Main Markdown Content Guidelines

The content below the frontmatter uses Markdown, with occasional embedded HTML for specific styling needs not easily achieved by the `.prose` Tailwind Typography plugin styles.

### 1. Main Title (Level 1 Heading)

Start the content with a Level 1 Markdown heading for the entry's title. This often mirrors the `title` from the frontmatter but might be slightly simplified (e.g., just "Barbarian" instead of "Barbarian (Class)").

```markdown
# Barbarian
```

### 2. Class Summary Table (For Class Entries - Custom HTML)

For class entries, a summary table provides a quick overview of core traits. This table uses custom HTML and Tailwind CSS classes to bypass some default `.prose` table styling and achieve a specific look.

*   **Wrapper Div**: Use `<div class="not-prose my-6">` to isolate this table from global `.prose` styles.
*   **Table Structure**: Standard HTML table (`<table>`, `<thead>`, `<tbody>`, `<tr>`, `<th>`, `<td>`).
*   **Styling**: Apply Tailwind CSS classes directly to the table elements as shown in the `barbarian.md` example for consistent appearance (borders, padding, text alignment, colors for headers and specific cells).
    *   Header cells (`<th>`): `px-4 py-3 text-left text-xs font-medium text-sky-300 uppercase tracking-wider border-b border-gray-600`
    *   Trait label cells (`<td>`): `px-4 py-3 text-sm font-medium text-amber-300 align-top`
    *   Trait detail cells (`<td>`): `px-4 py-3 text-sm text-gray-300 align-top`
*   **Content**: Include key class attributes like Primary Ability, Hit Die, Saving Throws, Proficiencies, Starting Equipment.

### 3. Horizontal Rule and Introductory Text

*   Use a Markdown horizontal rule (`---`) for visual separation after the summary table (if present) or title.
*   Provide 2-3 paragraphs of introductory or descriptive text for the glossary term.
*   Use `**bold text**` or `<em>italic text</em>` for emphasis on key terms within the introduction.

### 4. Section Headings (Level 2 and 3)

*   Use Level 2 Markdown headings (`##`) for major sections (e.g., "Becoming a Barbarian...", "Class Features", "Barbarian Subclass").
*   Use Level 3 Markdown headings (`###`) for sub-sections (e.g., "Path of the Berserker").

### 5. Class Features Table (For Class Entries - Markdown)

If applicable (like for class entries), a table summarizing features by level can be included using standard Markdown table syntax. This table **will** be styled by the global `.prose table` CSS.

```markdown
| Level | Proficiency Bonus | Class Features                               | ... |
|-------|-------------------|----------------------------------------------|-----|
| 1     | +2                | Rage, Unarmored Defense, Weapon Mastery      | ... |
```
*   You can use `<span data-term-id="term_id" class="glossary-term-link-from-markdown">Term</span>` within table headers or cells to link to other glossary terms.

### 6. Detailed Feature/Rule Explanations

This is where the bulk of the information for a term is provided.

*   **Standard Collapsible Details (`<details>` and `<summary>`)**:
    *   This is the **preferred method** for breaking down complex features, rules, or subtopics.
    *   **Structure**:
        ```html
        <details id="optional-unique-id-for-linking">
          <summary>Feature Name or Sub-Topic (e.g., Level 1: Rage)</summary>
          <div>
            <!-- Markdown content: paragraphs, lists, etc. -->
          </div>
        </details>
        ```
    *   These elements are styled by global CSS rules for `.prose details:not(.feature-card)` (defined in `index.html`), which includes specific background, padding, border, and caret styling.
    *   **Content within `<div>`**: Use standard Markdown (paragraphs, `<ul>`, `<ol>`), and `<strong>`/`<em>` for emphasis.
    *   **Nested `<details>`**: For very complex features, you can nest `<details>` elements. Apply minor custom margin/padding utility classes (e.g., `mt-2`, `pl-4`) directly to the nested `<details>` or its inner `<div>` if needed for better visual hierarchy, but try to rely on the global styles first.

*   **Feature Card Styling (`<details class="feature-card">`) - Optional & Sparingly Used**:
    *   The `.feature-card` class provides a more visually distinct, boxed style.
    *   **Use Case**: Reserve this for very prominent, standalone features, special callouts, or sidebars that need to break from the standard flow. It is **not** the default for typical feature descriptions.
    *   If used, the summary often contains an `<h3>` for its title:
        ```html
        <details class="feature-card">
          <summary><h3>Unique Feature Title</h3></summary>
          <div><!-- Content --></div>
        </details>
        ```

### 7. Consistent Terminology and Internal Linking

*   **Glossary Links**: For any D&D term, game mechanic, or related concept that has (or should have) its own glossary entry, embed a link using the following HTML `<span>` structure within your Markdown:
    ```html
    <span data-term-id="rage" class="glossary-term-link-from-markdown">Rage</span>
    ```
    *   `data-term-id`: **Must match the `id`** in the target glossary entry's frontmatter.
    *   `class="glossary-term-link-from-markdown"`: This class is targeted by `FullEntryDisplay.tsx` to make the link interactive (navigate to the linked term within the Glossary modal).
    *   The text content of the `<span>` (e.g., "Rage") is what the user sees.
*   **Emphasis**: Use `<strong>bold text</strong>` for feature names or very important terms that might not have their own dedicated glossary entry but need emphasis. Use `<em>italic text</em>` for spells, conditions, or general emphasis.

### 8. Markdown Formatting Best Practices

*   Use standard Markdown for paragraphs, lists, bold, italics.
*   Rely on the global `.prose` styling for general text, headings, lists, and standard Markdown tables.
*   Embed HTML (`<details>`, custom table for class summary) only when necessary for specific structural or styling requirements not easily achieved with pure Markdown and default `.prose` styles.

By following these guidelines, glossary entries will be consistent, informative, and well-integrated into the application's interactive glossary system.
Remember to run `node scripts/generateGlossaryIndex.js` (or your equivalent build command) after adding or significantly modifying glossary source files to update the JSON indexes.
And critically, ensure the Markdown files are also present in the `public/data/glossary/entries/` directory with the correct `filePath` in their frontmatter for the application to fetch and display them.
